limits = as.Date(c('2007-05-01','2022-08-21'))) + xlab('') +
theme(axis.text.x = element_blank(), axis.ticks.x=element_blank())
body3
fig <- body1 + body2 + body3 + body6 + body7 + body9 + plot_layout(ncol=3, nrow=2)
ggsave('/Users/kseniia/Desktop/Luk_fig1_Supp.pdf', plot=fig, device='pdf', scale=2, width=16, height=10, units='cm')
basdai <- ggplot(data[!is.na(data$BASDAI),],
aes(x=date, y=BASDAI)) +
geom_point(color='darkgoldenrod1') +
geom_line(color='darkgoldenrod1') +
theme_bw() +
geom_vline(xintercept = as.Date('2019-03-28'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2019-07-04'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2020-05-22'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2020-11-11'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2021-02-10'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2021-05-24'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2021-11-24'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2022-03-04'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2010-02-13'), linetype="dashed", color = "skyblue3", size=0.5) +
scale_x_date(breaks = date_breaks("years"), labels = date_format("%Y"),
limits = as.Date(c('2007-05-01','2022-08-21'))) + xlab('') +
theme(axis.text.x = element_blank(), axis.ticks.x=element_blank())
basdai
ASDAS <- ggplot(data[!is.na(data$ASDAS.CRP),],
aes(x=date, y=ASDAS.CRP)) +
geom_point(color='darkgoldenrod1') +
geom_line(color='darkgoldenrod1') +
theme_bw() +
geom_vline(xintercept = as.Date('2019-03-28'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2019-07-04'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2020-05-22'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2020-11-11'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2021-02-10'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2021-05-24'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2021-11-24'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2022-03-04'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2010-02-13'), linetype="dashed", color = "skyblue3", size=0.5) +
scale_x_date(breaks = date_breaks("years"), labels = date_format("%Y"),
limits = as.Date(c('2007-05-01','2022-08-21'))) + xlab('') +
theme(axis.text.x = element_blank(), axis.ticks.x=element_blank())
ASDAS
BASFI <- ggplot(data[!is.na(data$BASFI),],
aes(x=date, y=BASFI)) +
geom_point(color='darkgoldenrod1') +
geom_line(color='darkgoldenrod1') +
theme_bw() +
geom_vline(xintercept = as.Date('2019-03-28'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2019-07-04'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2020-05-22'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2020-11-11'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2021-02-10'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2021-05-24'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2021-11-24'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2022-03-04'), linetype="dashed", color = "olivedrab3", size=0.5) +
geom_vline(xintercept = as.Date('2010-02-13'), linetype="dashed", color = "skyblue3", size=0.5) +
scale_x_date(breaks = date_breaks("years"), labels = date_format("%Y"),
limits = as.Date(c('2007-05-01','2022-08-21'))) + xlab('') +
theme(axis.text.x = element_blank(), axis.ticks.x=element_blank())
BASFI
fig <- timeline_plot / (basdai + ASDAS + BASFI + body4 + body5 + body8 + plot_layout(ncol=3, nrow=2)) +  plot_layout(heights = c(1, 2))
fig <- basdai + ASDAS + BASFI + body4 + body5 + body8 + plot_layout(ncol=3, nrow=2)
ggsave('/Users/kseniia/Desktop/Luk_fig1.pdf', plot=fig, device='pdf', scale=2, width=16, height=10, units='cm')
check()
library(devtools)
check()
install()
document()
check()
library(devtools)
devtools::install_github('KseniaMIPT/tcrgrapher')
load("~/my_R_packages/tcrgrapher/VDJT.rda")
View(VDJT)
load("~/my_R_packages/tcrgrapher/data/OLGAVJ_MOUSE_TRB.rda")
View(OLGAVJ_MOUSE_TRB)
load("/Users/kseniia/Downloads/patho_benign_annovar.RData")
View(patho_benign_annovar)
ggplot(patho_benign_annovar, aes(x=CLINSIG, y=GERP_RS)) +
geom_boxplot()
library(ggplot2)
library(ggplot2)
ggplot(patho_benign_annovar, aes(x=CLINSIG, y=GERP_RS)) +
geom_boxplot()
ggplot(patho_benign_annovar, aes(x=CLINSIG, y=GERP_RS)) +
geom_boxplot() + theme_bw()
ggplot(patho_benign_annovar, aes(x=CLINSIG, y=GERP_RS)) +
geom_boxplot() + geom_point() + theme_bw()
ggplot(patho_benign_annovar, aes(x=CLINSIG, y=GERP_RS)) +
geom_boxplot() + theme_bw()
ggplot(patho_benign_annovar, aes(x=CLINSIG, y=AF)) +
geom_boxplot() + theme_bw()
ggplot(patho_benign_annovar, aes(x=CLINSIG, y=AF)) +
geom_boxplot() + theme_bw() + scale_y_log10()
ggplot(patho_benign_annovar, aes(x=CLINSIG, y=log10(AF))) +
geom_boxplot() + theme_bw() #+ scale_y_log10()
ggplot(patho_benign_annovar, aes(x=CLINSIG, y=AF)) +
geom_boxplot() + theme_bw() + scale_y_log10()
data <- read.delim('/Users/kseniia/Downloads/veb.tsv')
data <- data[data$CANONICAL != 'YES',]
data <- read.delim('/Users/kseniia/Downloads/veb.tsv')
data <- data[data$CANONICAL != 'YES',]
View(data)
data <- data[data$AF < 0.05,]
data <- data[data$gnomADe_AF < 0.05,]
data <- data[data$IMPACT != 'LOW',]
data <- data[!(data$PolyPhen %in% c('possibly_damaging', 'probably_damaging')),]
View(data)
data <- read.delim('/Users/kseniia/Downloads/veb.tsv')
data <- data[data$CANONICAL != 'YES',]
data <- data[data$AF < 0.05,]
data <- data[data$gnomADe_AF < 0.05,]
data <- data[data$IMPACT != 'LOW',]
data <- data[!(data$PolyPhen %in% c('possibly_damaging', 'probably_damaging')),]
View(data)
data <- read.delim('/Users/kseniia/Downloads/veb.tsv')
data <- data[data$CANONICAL != 'YES',]
data <- data[data$AF < 0.05,]
data <- data[data$gnomADe_AF < 0.05,]
data <- data[data$IMPACT != 'LOW',]
data <- data[!(data$PolyPhen %in% c('possibly_damaging', 'probably_damaging', '-')),]
View(data)
data <- read.delim('/Users/kseniia/Downloads/veb.tsv')
data <- data[data$CANONICAL == 'YES',]
data <- data[data$AF < 0.05,]
data <- data[data$gnomADe_AF < 0.05,]
data <- data[data$IMPACT != 'LOW',]
data <- data[!(data$PolyPhen %in% c('possibly_damaging', 'probably_damaging', '-')),]
library(stringr)
str_detect('possibly_damaging(1)', 'possibly_damaging')
TRUE + TRUE
TRUE & TRUE
data <- read.delim('/Users/kseniia/Downloads/veb.tsv')
data <- data[data$CANONICAL == 'YES',]
data <- data[data$AF == '-','AF'] <- -1
data$AF <- as.numeric(data$AF)
data <- read.delim('/Users/kseniia/Downloads/veb.tsv')
data <- data[data$CANONICAL == 'YES',]
data <- data[data$AF == '-','AF'] <- -1
data <- read.delim('/Users/kseniia/Downloads/veb.tsv')
data <- data[data$CANONICAL == 'YES',]
data[data$AF == '-','AF'] <- -1
data$AF <- as.numeric(data$AF)
data <- data[data$AF < 0.05,]
data[data$gnomADe_AF == '-','gnomADe_AF'] <- -1
data$gnomADe_AF <- as.numeric(data$gnomADe_AF)
data <- data[data$gnomADe_AF < 0.05,]
data <- data[data$IMPACT != 'LOW',]
data <- data[str_detect(data$PolyPhen, 'possibly_damaging') &
str_detect(data$PolyPhen, 'probably_damaging') &
data$PolyPhen == '-',]
View(data)
data <- read.delim('/Users/kseniia/Downloads/veb.tsv')
data <- data[data$CANONICAL == 'YES',]
data[data$AF == '-','AF'] <- -1
data$AF <- as.numeric(data$AF)
data <- data[data$AF < 0.05,]
data[data$gnomADe_AF == '-','gnomADe_AF'] <- -1
data$gnomADe_AF <- as.numeric(data$gnomADe_AF)
data <- data[data$gnomADe_AF < 0.05,]
View(data)
data <- data[data$IMPACT != 'LOW',]
data <- data[str_detect(data$PolyPhen, 'possibly_damaging') &
str_detect(data$PolyPhen, 'probably_damaging') &
data$PolyPhen == '-',]
data <- read.delim('/Users/kseniia/Downloads/veb.tsv')
data <- data[data$CANONICAL == 'YES',]
data[data$AF == '-','AF'] <- -1
data$AF <- as.numeric(data$AF)
data <- data[data$AF < 0.05,]
data[data$gnomADe_AF == '-','gnomADe_AF'] <- -1
data$gnomADe_AF <- as.numeric(data$gnomADe_AF)
data <- data[data$gnomADe_AF < 0.05,]
data <- data[data$IMPACT != 'LOW',]
data[str_detect(data$PolyPhen, 'possibly_damaging'),]
data[str_detect(data$PolyPhen, 'possibly_damaging'),'PolyPhen']
str_detect(data$PolyPhen, 'probably_damaging')
data$PolyPhen == '-'
str_detect(data$PolyPhen, 'possibly_damaging') &
str_detect(data$PolyPhen, 'probably_damaging') &
data$PolyPhen == '-'
str_detect(data$PolyPhen, 'possibly_damaging') &
str_detect(data$PolyPhen, 'probably_damaging') &
(data$PolyPhen == '-')
data <- data[str_detect(data$PolyPhen, 'possibly_damaging') |
str_detect(data$PolyPhen, 'probably_damaging') |
(data$PolyPhen == '-'),]
data <- read.delim('/Users/kseniia/Downloads/veb.tsv')
data <- data[data$CANONICAL == 'YES',]
data[data$AF == '-','AF'] <- -1
data$AF <- as.numeric(data$AF)
data <- data[data$AF < 0.05,]
data[data$gnomADe_AF == '-','gnomADe_AF'] <- -1
data$gnomADe_AF <- as.numeric(data$gnomADe_AF)
data <- data[data$gnomADe_AF < 0.05,]
data <- data[data$IMPACT != 'LOW',]
data <- data[str_detect(data$PolyPhen, 'possibly_damaging') |
str_detect(data$PolyPhen, 'probably_damaging') |
(data$PolyPhen == '-'),]
View(data)
genes <- read.delim('/Users/kseniia/Downloads/rpgenes.tsv')
genes <- read.delim('/Users/kseniia/Downloads/rpgenes.txt')
View(genes)
genes <- read.delim('/Users/kseniia/Downloads/rpgenes.txt', header = FALSE)
data[data$SYMBOL %in% genes$V1],
data[data$SYMBOL %in% genes$V1,]
data <- read.delim('/Users/kseniia/Downloads/veb.tsv')
data <- data[data$CANONICAL == 'YES',]
data[data$AF == '-','AF'] <- -1
data$AF <- as.numeric(data$AF)
data <- data[data$AF < 0.05,]
data[data$gnomADe_AF == '-','gnomADe_AF'] <- -1
data$gnomADe_AF <- as.numeric(data$gnomADe_AF)
data <- data[data$gnomADe_AF < 0.05,]
data <- data[data$IMPACT != 'LOW',]
data <- data[str_detect(data$PolyPhen, 'possibly_damaging') |
str_detect(data$PolyPhen, 'probably_damaging') |
(data$PolyPhen == '-'),]
data
genes <- read.delim('/Users/kseniia/Downloads/rpgenes.txt', header = FALSE)
data[data$SYMBOL %in% genes$V1,]
data <- read.delim('/Users/kseniia/Downloads/veb.tsv')
data <- data[data$CANONICAL == 'YES',]
data[data$AF == '-','AF'] <- -1
data$AF <- as.numeric(data$AF)
data <- data[data$AF < 0.05,]
data[data$gnomADe_AF == '-','gnomADe_AF'] <- -1
data$gnomADe_AF <- as.numeric(data$gnomADe_AF)
data <- data[data$gnomADe_AF < 0.05,]
data <- data[data$IMPACT != 'LOW',]
data
View(data)
data <- read.delim('/Users/kseniia/Downloads/veb2.tsv')
data <- data[data$CANONICAL == 'YES',]
data[data$AF == '-','AF'] <- -1
data$AF <- as.numeric(data$AF)
data <- data[data$AF < 0.05,]
data[data$gnomADe_AF == '-','gnomADe_AF'] <- -1
data$gnomADe_AF <- as.numeric(data$gnomADe_AF)
data <- data[data$gnomADe_AF < 0.05,]
data <- data[data$IMPACT != 'LOW',]
data
View(data)
data <- read.delim('/Users/kseniia/Downloads/veb.tsv')
data <- data[data$CANONICAL == 'YES',]
data[data$AF == '-','AF'] <- -1
data$AF <- as.numeric(data$AF)
data <- data[data$AF < 0.05,]
data[data$gnomADe_AF == '-','gnomADe_AF'] <- -1
data$gnomADe_AF <- as.numeric(data$gnomADe_AF)
data <- data[data$gnomADe_AF < 0.05,]
data <- data[data$IMPACT != 'LOW',]
data <- data[str_detect(data$PolyPhen, 'possibly_damaging') |
str_detect(data$PolyPhen, 'probably_damaging') |
(data$PolyPhen == '-'),]
data
colname(data)
colnames(data)
data2 <- read.delim('/Users/kseniia/Downloads/veb2.tsv')
data2 <- data2[data2$CANONICAL == 'YES',]
data2[data2$AF == '-','AF'] <- -1
data2$AF <- as.numeric(data2$AF)
data2 <- data2[data2$AF < 0.05,]
data2[data2$gnomADe_AF == '-','gnomADe_AF'] <- -1
data2$gnomADe_AF <- as.numeric(data2$gnomADe_AF)
data2 <- data2[data2$gnomADe_AF < 0.05,]
data2 <- data2[data2$IMPACT != 'LOW',]
data2
colnames(data2)[!(colnames(data2) %in% colnames(data))]
data2 <- read.delim('/Users/kseniia/Downloads/veb2.tsv')
data2 <- data2[data2$CANONICAL == 'YES',]
data2[data2$AF == '-','AF'] <- -1
data2$AF <- as.numeric(data2$AF)
data2 <- data2[data2$AF < 0.05,]
data2[data2$gnomADe_AF == '-','gnomADe_AF'] <- -1
data2$gnomADe_AF <- as.numeric(data2$gnomADe_AF)
data2 <- data2[data2$gnomADe_AF < 0.05,]
data2 <- data2[data2$IMPACT != 'LOW',]
data2 <- [data2$CADD_PHRED > 20,]
data2 <- read.delim('/Users/kseniia/Downloads/veb2.tsv')
data2 <- data2[data2$CANONICAL == 'YES',]
data2[data2$AF == '-','AF'] <- -1
data2$AF <- as.numeric(data2$AF)
data2 <- data2[data2$AF < 0.05,]
data2[data2$gnomADe_AF == '-','gnomADe_AF'] <- -1
data2$gnomADe_AF <- as.numeric(data2$gnomADe_AF)
data2 <- data2[data2$gnomADe_AF < 0.05,]
data2 <- data2[data2$IMPACT != 'LOW',]
data2 <- data2[data2$CADD_PHRED > 20,]
View(data2)
data2 <- read.delim('/Users/kseniia/Downloads/veb2.tsv')
data2 <- data2[data2$CANONICAL == 'YES',]
data2[data2$AF == '-','AF'] <- -1
data2$AF <- as.numeric(data2$AF)
data2 <- data2[data2$AF < 0.05,]
data2[data2$gnomADe_AF == '-','gnomADe_AF'] <- -1
data2$gnomADe_AF <- as.numeric(data2$gnomADe_AF)
data2 <- data2[data2$gnomADe_AF < 0.05,]
data2 <- data2[data2$IMPACT != 'LOW',]
data2 <- data2[data2$CADD_PHRED < 20,]
data2 <- read.delim('/Users/kseniia/Downloads/veb2.tsv')
data2 <- data2[data2$CANONICAL == 'YES',]
data2[data2$AF == '-','AF'] <- -1
data2$AF <- as.numeric(data2$AF)
data2 <- data2[data2$AF < 0.05,]
data2[data2$gnomADe_AF == '-','gnomADe_AF'] <- -1
data2$gnomADe_AF <- as.numeric(data2$gnomADe_AF)
data2 <- data2[data2$gnomADe_AF < 0.05,]
data2 <- data2[data2$IMPACT != 'LOW',]
data2 <- data2[data2$CADD_PHRED > 20,]
data2 <- read.delim('/Users/kseniia/Downloads/veb2.tsv')
data2 <- data2[data2$CANONICAL == 'YES',]
data2[data2$AF == '-','AF'] <- -1
data2$AF <- as.numeric(data2$AF)
data2 <- data2[data2$AF < 0.05,]
data2[data2$gnomADe_AF == '-','gnomADe_AF'] <- -1
data2$gnomADe_AF <- as.numeric(data2$gnomADe_AF)
data2 <- data2[data2$gnomADe_AF < 0.05,]
data2 <- data2[data2$IMPACT != 'LOW',]
data2 <- data2[data2$CADD_PHRED > 20,]
data2
load ("/Users/kseniia/Downloads/patho_benign_annovar.RData")
BiocManager::install("MutationalPatterns")
library(MutationalPatterns)
BiocManager::install("BSgenome")
library(MutationalPatterns)
library(ggplot2)
BiocManager::install("BSgenome")
library(ggplot2)
library(MutationalPatterns)
library(gridExtra)
BiocManager::install("BSgenome.Hsapiens.UCSC.hg19")
ref_genome <- "BSgenome.Hsapiens.UCSC.hg19"
library(ref_genome, character.only = TRUE)
BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene")
library("TxDb.Hsapiens.UCSC.hg19.knownGene")
genes_hg19 <- genes(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(ggplot2)
library(MutationalPatterns)
library(gridExtra)
ref_genome <- "BSgenome.Hsapiens.UCSC.hg19"
library(ref_genome, character.only = TRUE)
library("TxDb.Hsapiens.UCSC.hg19.knownGene")
genes_hg19 <- genes(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(ggplot2)
library(MutationalPatterns)
library(gridExtra)
ref_genome <- "BSgenome.Hsapiens.UCSC.hg19"
library(ref_genome, character.only = TRUE)
library("TxDb.Hsapiens.UCSC.hg19.knownGene")
genes_hg19 <- genes(TxDb.Hsapiens.UCSC.hg19.knownGene)
path <- '/Users/kseniia/Downloads/training_data/'
vcf_files <- list.files(path, pattern="TCGA*")
vcf_files
sample_names <- c("LUAD1","LUAD2","LUAD3","UCEC1","COAD1","UCEC2","UCEC3",
"BLCA1","HNSC1","HNSC2","COAD2","SKCM1","SKCM2","BLCA2","READ1")
vcfs <- read_vcfs_as_granges(vcf_files, sample_names, ref_genome, type = "all")
?read_vcfs_as_granges
sample_names <- c("LUAD1","LUAD2","LUAD3","UCEC1","COAD1","UCEC2","UCEC3",
"BLCA1","HNSC1","HNSC2","COAD2","SKCM1","SKCM2","BLCA2","READ1")
vcfs <- read_vcfs_as_granges(paste0(path, vcf_files), sample_names, ref_genome, type = "all")
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
type_occurrences
plot_spectrum(type_occurrences, by = sample_names, CT = TRUE, legend = TRUE)
tiff(filename="path_to_fig/Figure1_yourSurname.tiff", width=8, height=8, res=300, units='in')
plot_spectrum(type_occurrences, by = sample_names, CT = TRUE, legend = TRUE)
dev.off()
tiff(filename="path_to_fig/Figure1_yourSurname.tiff", width=8, height=8, res=300, units='in')
plot_spectrum(type_occurrences, by = sample_names, CT = TRUE, legend = TRUE)
#dev.off()
tiff(filename="path_to_fig/Figure1_yourSurname.tiff", width=8, height=8, res=300, units='in')
plot_spectrum(type_occurrences, by = sample_names, CT = TRUE, legend = TRUE)
#dev.off()
#tiff(filename="path_to_fig/Figure1_yourSurname.tiff", width=8, height=8, res=300, units='in')
plot_spectrum(type_occurrences, by = sample_names, CT = TRUE, legend = TRUE)
#dev.off()
mut_mat <- mut_matrix(vcf_list = vcfs, ref_genome = ref_genome)
plot_96_profile(mut_mat[,c(5,12)], condensed = TRUE)
cancer_signatures = read.table(paste0(path, "signatures_probabilities.txt"),
sep = "\t", header = TRUE)
new_order = match(row.names(mut_mat), cancer_signatures$Somatic.Mutation.Type)
cancer_signatures = cancer_signatures[as.vector(new_order),]
row.names(cancer_signatures) = cancer_signatures$Somatic.Mutation.Type
cancer_signatures = as.matrix(cancer_signatures[,4:33])
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
type_occurrences
type_occurrences$all_mutations <- apply(type_occurrences[,1:6], 2, sum)
type_occurrences$all_mutations <- apply(type_occurrences[,1:6], 1, sum)
type_occurrences
type_occurrences$all_mutations <- apply(type_occurrences[,1:6], 1, sum)
type_occurrences$prop_CpG_to_TpG <- type_occurrences$`C>T at CpG`/type_occurrences$all_mutations
type_occurrences[,c('all_mutations', 'C>T' 'prop_CpG_to_TpG')]
type_occurrences$prop_CpG_to_TpG <- type_occurrences$`C>T at CpG`/type_occurrences$all_mutations
type_occurrences[,c('all_mutations', 'C>T' 'prop_CpG_to_TpG')]
type_occurrences#[,c('all_mutations', 'C>T' 'prop_CpG_to_TpG')]
colnames(type_occurrences)
type_occurrences$all_mutations <- apply(type_occurrences[,1:6], 1, sum)
type_occurrences$prop_CpG_to_TpG <- type_occurrences$`C>T at CpG`/type_occurrences$all_mutations
type_occurrences[,c('all_mutations', 'C>T', 'prop_CpG_to_TpG')]
type_occurrences <- mut_type_occurrences(vcfs, ref_genome)
type_occurrences
type_occurrences$all_mutations <- apply(type_occurrences[,1:6], 1, sum)
type_occurrences$prop_CpG_to_TpG <- type_occurrences$`C>T at CpG`/type_occurrences$all_mutations
type_occurrences[,c('all_mutations', 'C>T', 'prop_CpG_to_TpG')]
cancer_signatures = read.table(paste0(path, "signatures_probabilities.txt"),
sep = "\t", header = TRUE)
new_order = match(row.names(mut_mat), cancer_signatures$Somatic.Mutation.Type)
cancer_signatures = cancer_signatures[as.vector(new_order),]
row.names(cancer_signatures) = cancer_signatures$Somatic.Mutation.Type
cancer_signatures = as.matrix(cancer_signatures[,4:33])
fit_res <- fit_to_signatures(mut_mat, cancer_signatures)
contribution <- plot_contribution(fit_res$contribution, cancer_signatures,
coord_flip = FALSE, mode = "relative")
contribution
reconstruction <- plot_original_vs_reconstructed(mut_mat, fit_res$reconstructed,
y_intercept=0.95)
reconstruction
strict_refit_small_d <- fit_to_signatures_strict(mut_mat, cancer_signatures, max_delta = 0.005)
fit_res_strict_small_d<- strict_refit_small_d$fit_res
strict_refit_big_d <- fit_to_signatures_strict(mut_mat, cancer_signatures, max_delta = 0.05)
fit_res_strict_big_d<- strict_refit_big_d$fit_res
cancer_signatures = read.table(paste0(path, "signatures_probabilities.txt"),
sep = "\t", header = TRUE)
new_order = match(row.names(mut_mat), cancer_signatures$Somatic.Mutation.Type)
cancer_signatures = cancer_signatures[as.vector(new_order),]
row.names(cancer_signatures) = cancer_signatures$Somatic.Mutation.Type
cancer_signatures = as.matrix(cancer_signatures[,4:33])
fit_res <- fit_to_signatures(mut_mat, cancer_signatures)
contribution <- plot_contribution(fit_res$contribution, cancer_signatures,
coord_flip = FALSE, mode = "relative")
contribution
reconstruction <- plot_original_vs_reconstructed(mut_mat, fit_res$reconstructed,
y_intercept=0.95)
reconstruction
strict_refit_small_d <- fit_to_signatures_strict(mut_mat, cancer_signatures, max_delta = 0.005)
fit_res_strict_small_d<- strict_refit_small_d$fit_res
strict_refit_big_d <- fit_to_signatures_strict(mut_mat, cancer_signatures, max_delta = 0.05)
fit_res_strict_big_d<- strict_refit_big_d$fit_res
contribution_strict_small_d <- plot_contribution(fit_res_strict_small_d$contribution,
cancer_signatures,
coord_flip = FALSE,  mode= "relative")
contribution_strict_big_d <- plot_contribution(fit_res_strict_big_d$contribution,
cancer_signatures, coord_flip = FALSE,
mode = "relative")
grid.arrange(contribution, contribution_strict_small_d, contribution_strict_big_d)
reconstruction_strict_small_d <- plot_original_vs_reconstructed(mut_mat,
fit_res_strict_small_d$reconstructed,
y_intercept = 0.95)
reconstruction_strict_big_d <- plot_original_vs_reconstructed(mut_mat,
fit_res_strict_big_d$reconstructed,
y_intercept = 0.95)
grid.arrange(reconstruction, reconstruction_strict_small_d, reconstruction_strict_big_d)
plot_contribution_heatmap(fit_res_strict_small_d$contribution,  cluster_samples = TRUE,
method = "complete")
contri_boots <- fit_to_signatures_bootstrapped(mut_mat,  cancer_signatures, n_boots = 100,
max_delta = 0.05, method = "strict")
contri_boots <- fit_to_signatures_bootstrapped(mut_mat,  cancer_signatures, n_boots = 100,
max_delta = 0.05, method = "strict")
plot_bootstrapped_contribution(contri_boots, mode = "relative", plot_type = "dotplot")
fig_list <- plot_correlation_bootstrap(contri_boots)
fig_list[11]
Tas = ((859448 + 619751)/(119113999 + 124231848)) / ((613475 + 831076)/(119774303 + 114770166))
Tas
?grid.arrange
grid.arrange(contribution, contribution_strict_small_d, contribution_strict_big_d)
contribution
contribution_strict_small_d
contribution_strict_big_d
contribution_strict_small_d <- plot_contribution(fit_res_strict_small_d$contribution,
cancer_signatures,
coord_flip = TRUE,  mode= "relative")
contribution_strict_big_d <- plot_contribution(fit_res_strict_big_d$contribution,
cancer_signatures, coord_flip = FALSE,
mode = "relative")
contribution
contribution_strict_small_d
contribution_strict_big_d
contribution_strict_small_d <- plot_contribution(fit_res_strict_small_d$contribution,
cancer_signatures,
coord_flip = TRUE,  mode= "relative")
contribution_strict_big_d <- plot_contribution(fit_res_strict_big_d$contribution,
cancer_signatures, coord_flip = TRUE,
mode = "relative")
contribution
contribution_strict_small_d
contribution_strict_big_d
contribution <- plot_contribution(fit_res$contribution, cancer_signatures,
coord_flip = TRUE, mode = "relative")
contribution
contribution
contribution_strict_small_d
contribution_strict_big_d
reconstruction
reconstruction_strict_small_d
reconstruction_strict_big_d)
reconstruction
reconstruction_strict_small_d
reconstruction_strict_big_d
vcf_files <- list.files(path, pattern="*_3000.vcf")
samples_names_all <- c("LUAD","SKCM")
vcfs_all <- read_vcfs_as_granges(vcf_files, samples_names_all, ref_genome,  type = "all")
vcf_files <- list.files(path, pattern="*_3000.vcf")
samples_names_all <- c("LUAD","SKCM")
vcfs_all <- read_vcfs_as_granges(paste0(path, vcf_files), samples_names_all, ref_genome,  type = "all")
mut_mat_s <- mut_matrix_stranded(vcfs_all, ref_genome, genes_hg19)
strand_counts <- strand_occurrences(mut_mat_s, by=samples_names_all)
head(strand_counts)
strand_bias <- strand_bias_test(strand_counts)
strand_bias
ps1 <- plot_strand(strand_counts, mode = "relative")
ps1
ps2 <- plot_strand_bias(strand_bias)
ps2
?read.delim
